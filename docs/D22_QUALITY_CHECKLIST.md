# D22 データ品質チェックリスト

## 概要
生成されたQ&Aデータの品質を保証するための検証基準とプロセス。

---

## 🔍 必須項目（MUST）

### 1. 構造的完全性
- [ ] すべての必須フィールドが存在
  - `id`, `category`, `question`, `ground_truth`, `context`
  - `difficulty`, `verified`, `created_at`

### 2. 質問の品質
- [ ] 質問長: 20-200文字
- [ ] 具体的シナリオを含む
- [ ] 「どうやって」「方法は」等の抽象的表現を回避
- [ ] 技術的に正確

**良い例**:
```
✅ "Azure AI SearchでHNSWのm=4とm=16では、どちらが検索速度が速いですか？"
```

**悪い例**:
```
❌ "Azure AI Searchの使い方を教えてください"
❌ "ベクトル検索とは何ですか？"
```

### 3. Ground Truthの品質
- [ ] 回答長: 50-500文字
- [ ] 検証可能な事実のみ
- [ ] Azure公式ドキュメントに基づく
- [ ] 主観的表現を回避（「一般的に」「通常」等）

**良い例**:
```
✅ "m=4の方が検索速度が速いです。パラメータmはグラフの接続数を表し、値が小さいほど探索時の計算量が減少します。"
```

**悪い例**:
```
❌ "一般的には性能が向上すると言われています"
❌ "場合によります"
```

### 4. コンテキストの品質
- [ ] 最低1件以上
- [ ] 具体的な情報源を明記
- [ ] "Azure公式ドキュメント"だけでなく、より具体的な参照

**良い例**:
```
✅ ["Azure AI Search公式: HNSW Configuration", "推奨パラメータ範囲: m=4-16"]
```

**悪い例**:
```
❌ ["公式ドキュメント", "マイクロソフトの資料"]
```

### 5. 重複排除
- [ ] 既存データとの類似度 < 0.8
- [ ] 新規生成データ間の類似度 < 0.8
- [ ] IDの一意性

---

## ⚡ 推奨項目（SHOULD）

### 1. カテゴリバランス
- [ ] 各カテゴリが目標件数に近い
  - Azure AI Search: 25件 (±3件)
  - Security & Identity: 25件 (±3件)
  - Infrastructure: 20件 (±2件)
  - Python SDK: 15件 (±2件)
  - Architecture Patterns: 15件 (±2件)

### 2. 難易度分散
- [ ] Beginner: 20-30%
- [ ] Intermediate: 50-60%
- [ ] Advanced: 20-30%

### 3. タグの適切性
- [ ] 2-5個のタグ
- [ ] 技術的に関連性あり

---

## 🚫 禁止事項（MUST NOT）

### 1. 内容的禁止
- [ ] 架空のサービス名・機能
- [ ] 検証不可能な主観的回答
- [ ] 誤った技術情報
- [ ] 時代遅れの情報（2024年以前の古い仕様）

### 2. 構造的禁止
- [ ] 空のフィールド
- [ ] 不正なJSON構造
- [ ] 文字コードエラー（非UTF-8）

---

## 🔄 検証プロセス

### Phase 1: 自動バリデーション（100%）
```python
# scripts/validate_qa_quality.pyで実行
- 構造チェック
- 長さチェック
- 重複チェック
- カテゴリバランスチェック
```

### Phase 2: サンプリングチェック（20%）
```
- ランダム20%を人間が確認
- 技術的正確性の検証
- 質問の適切性確認
```

### Phase 3: 最終レビュー
```
- 全体のカテゴリバランス
- 難易度分布
- 総合品質評価
```

---

## 📊 品質メトリクス

### 目標値
- 構造チェック合格率: 100%
- 長さチェック合格率: ≥95%
- 重複率: 0%
- サンプリングチェック合格率: ≥90%

### 不合格時の対応
1. 自動修正可能な場合: 自動修正実行
2. 手動修正必要な場合: 該当データをマーク
3. 再生成必要な場合: 該当カテゴリを再生成

---

## ✅ チェックリスト使用例

```bash
# 1. 生成データに対してバリデーション実行
python scripts/validate_qa_quality.py data/test_qa_generated.json

# 2. レポート確認
cat reports/validation_report.txt

# 3. 問題があればfixedファイル生成
python scripts/fix_qa_issues.py data/test_qa_generated.json

# 4. 修正後データ確認
python scripts/validate_qa_quality.py data/test_qa_fixed.json
```

---

## 📝 記録

### バリデーション履歴
| 日時 | ファイル | 総件数 | 合格 | 不合格 | 合格率 |
|------|---------|--------|------|--------|--------|
| 2024-12-24 | test_qa_generated.json | 3 | 3 | 0 | 100% |

---

**最終更新**: 2024-12-24
**次回レビュー**: バッチ生成完了時（Day 2）